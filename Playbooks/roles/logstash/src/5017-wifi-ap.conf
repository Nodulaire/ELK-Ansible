
# Log example :
# Jun 28 07:00:01 10.6.68.131 [notice] local7 : %SYS-5-CONFIG_I: Configured from 10.6.7.252 by snmp
# Jun 28 07:00:01 10.6.68.131 [notice] local7 : %LINK-5-CHANGED: Interface Dot11Radio0, changed state to reset
# Jun 28 07:00:01 10.6.68.131 [notice] local7 : %SYS-5-CONFIG_I: Configured from 10.6.7.252 by snmp
# Jun 28 07:00:01 10.6.68.131 [info] local7 : %LINK-6-UPDOWN: Interface Dot11Radio1, changed state to up
# Jun 28 07:00:02 10.6.68.131 [info] local7 : %LINK-6-UPDOWN: Interface Dot11Radio0, changed state to up
# Jun 28 07:00:02 10.6.68.131 [notice] local7 : %LINK-5-CHANGED: Interface Dot11Radio1, changed state to reset
# Jun 28 07:00:03 10.6.68.131 [notice] local7 : %LINEPROTO-5-UPDOWN: Line protocol on Interface Dot11Radio0, changed state to up
# Jun 28 07:00:03 10.6.68.131 [info] local7 : %LINK-6-UPDOWN: Interface Dot11Radio1, changed state to up
# Jun 28 07:00:04 10.6.68.131 [notice] local7 : %LINEPROTO-5-UPDOWN: Line protocol on Interface Dot11Radio1, changed state to up
# Jun 28 08:16:46 10.6.68.131 [info] local7 : %DOT11-6-ASSOC: Interface Dot11Radio0, Station   24db.ed6d.066b Associated KEY_MGMT[NONE]
# Jun 28 08:16:46 10.6.68.131 [info] local7 : %DOT11-6-DISASSOC: Interface Dot11Radio0, Deauthenticating Station 24db.ed6d.066b Reason: Sending station has left the BSS
# Jun 28 08:42:24 10.6.68.131 [info] local7 : %DOT11-6-ASSOC: Interface Dot11Radio1, Station AP-3-HallC e09d.3115.418c Associated KEY_MGMT[WPAv2-CP]
# Jun 28 08:42:39 10.6.68.131 [info] local7 : %DOT11-6-ROAMED: Station e09d.3115.418c Roamed to 544a.0058.8e90
# Jun 28 08:42:39 10.6.68.131 [info] local7 : %DOT11-6-DISASSOC: Interface Dot11Radio1, Deauthenticating Station e09d.3115.418c Reason: Sending station has left the BSS
# Jun 28 09:21:05 10.6.68.131 [info] local7 : %DOT11-6-ASSOC: Interface Dot11Radio0, Station   5427.58b2.6bab Associated KEY_MGMT[NONE]
# Jun 28 09:43:48 10.6.68.131 [info] local7 : %DOT11-6-DISASSOC: Interface Dot11Radio0, Deauthenticating Station 5427.58b2.6bab Reason: Sending station has left the BSS
# Jun 28 09:59:24 10.6.68.131 [info] local7 : %DOT11-6-ROAMED: Station ec35.8658.99fe Roamed to 544a.0058.8e90
# Jun 28 10:01:10 10.6.68.131 [warning] local7 : %DOT11-4-MAXRETRIES: Packet to client ec35.8658.99fe reached max retries, removing the client
# Jun 28 10:05:08 10.6.68.131 [info] local7 : %DOT11-6-ASSOC: Interface Dot11Radio1, Station   ec35.8658.99fe Associated KEY_MGMT[WPAv2]
# Jun 28 10:13:28 10.6.68.131 [info] local7 : %DOT11-6-ROAMED: Station ec35.8658.99fe Roamed to 544a.0058.8e90
# Jun 28 10:13:28 10.6.68.131 [info] local7 : %DOT11-6-DISASSOC: Interface Dot11Radio1, Deauthenticating Station ec35.8658.99fe Reason: Sending station has left the BSS
# Jun 28 10:38:47 10.6.68.131 [info] local7 : %DOT11-6-ASSOC: Interface Dot11Radio1, Station AP-3-HallC 8086.f28e.9347 Associated KEY_MGMT[WPAv2]
# Jun 28 11:11:27 10.6.68.131 [info] local7 : %DOT11-6-ASSOC: Interface Dot11Radio1, Station AP-3-HallC 0c8b.fd98.c5d3 Associated KEY_MGMT[WPAv2]
# Jun 28 11:12:50 10.6.68.131 [info] local7 : %DOT11-6-DISASSOC: Interface Dot11Radio1, Deauthenticating Station 8086.f28e.9347 Reason: Sending station has left the BSS

# On dirait du cisco -> Chercher un grock
# https://www.linkedin.com/pulse/cisco-syslog-logstash-daniel-gilbertson-5994871489260695552
input{
  tcp {
      mode => server
      port => 5015
      type => "syslog-relay"
  }
}

output {
  # If your elasticsearch server is discoverable with multicast, use this:
  # elasticsearch { }
  elasticsearch { hosts => "10.6.7.232:9200" }
}
